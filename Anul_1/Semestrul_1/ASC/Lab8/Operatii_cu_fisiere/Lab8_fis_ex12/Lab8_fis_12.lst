     1                                  bits 32
     2                                  
     3                                  global start        
     4                                  
     5                                  extern exit, fopen, fclose, scanf, fprintf, printf
     6                                  import exit msvcrt.dll
     7                                  import fopen msvcrt.dll
     8                                  import fclose msvcrt.dll
     9                                  import scanf msvcrt.dll
    10                                  import fprintf msvcrt.dll
    11                                  import printf msvcrt.dll
    12                                  
    13                                  segment data use32 class=data
    14 00000000 6669736965722E7478-         nume_fisier db "fisier.txt", 0
    14 00000009 7400               
    15 0000000B 7700                        mod_acces db "w", 0
    16 0000000D FFFFFFFF                    descriptor dd -1
    17                                      
    18 00000011 00000000                    n dd 0
    19                                      
    20 00000015 496E74726F64756365-         mesaj_citire db "Introduceti un numar: ", 0
    20 0000001E 746920756E206E756D-
    20 00000027 61723A2000         
    21 0000002C 256400                      format_citire db "%d", 0
    22 0000002F 25642000                    format_afisare db "%d ", 0
    23                                      
    24 00000033 446573636869646572-         eroare db "Deschiderea fisierului a esuat", 0
    24 0000003C 656120666973696572-
    24 00000045 756C75692061206573-
    24 0000004E 75617400           
    25                                  
    26                                  ; 12. Se da un nume de fisier (definit in segmentul de date). Sa se creeze un fisier cu numele dat, apoi sa se citeasca de la tastatura numere si sa se scrie valorile citite in fisier pana cand se citeste de la tast
    27                                  segment code use32 class=code
    28                                      start:
    29                                          ; fopnen(nume_fisier, mod_acces)
    30 00000000 68[0B000000]                    push dword mod_acces
    31 00000005 68[00000000]                    push dword nume_fisier
    32 0000000A FF15[00000000]                  call [fopen]
    33 00000010 83C408                          add esp, 4*2
    34                                          
    35 00000013 83F800                          cmp eax, 0
    36 00000016 0F84(33000000)                  je eroare
    37                                          
    38 0000001C A3[0D000000]                    mov [descriptor], eax
    39                                          
    40                                          repeta:
    41                                              ; mesaj citire
    42 00000021 68[15000000]                        push dword mesaj_citire
    43 00000026 FF15[00000000]                      call [printf]
    44 0000002C 83C404                              add esp, 4
    45                                              
    46                                              ; scanf(format, val)
    47 0000002F 68[11000000]                        push dword n
    48 00000034 68[2C000000]                        push dword format_citire
    49 00000039 FF15[00000000]                      call [scanf]
    50 0000003F 83C408                              add esp, 4*2
    51                                              
    52                                              ; comparam cu 0
    53 00000042 A1[11000000]                        mov eax, [n]
    54 00000047 83F800                              cmp eax, 0
    55 0000004A 741C                                je afara
    56                                              
    57                                              ; fprintf(descriptor, format, val)
    58 0000004C FF35[11000000]                      push dword [n]
    59 00000052 68[2F000000]                        push dword format_afisare
    60 00000057 FF35[0D000000]                      push dword [descriptor]
    61 0000005D FF15[00000000]                      call [fprintf]
    62 00000063 83C40C                              add esp, 4*3
    63                                              
    64 00000066 EBB9                                jmp repeta
    65                                              
    66                                          afara:
    67                                          
    68                                          ;fclose(descriptor)
    69 00000068 FF35[0D000000]                  push dword [descriptor]
    70 0000006E FF15[00000000]                  call [fclose]
    71 00000074 83C404                          add esp, 4
    72                                          
    73 00000077 EB0E                            jmp final
    74                                          eroare_deschidere:
    75 00000079 68[33000000]                        push dword eroare
    76 0000007E FF15[00000000]                      call [printf]
    77 00000084 83C404                              add esp, 4
    78                                          
    79                                          final:
    80                                          ; exit(0)
    81 00000087 6A00                            push    dword 0      ; push the parameter for exit onto the stack
    82 00000089 FF15[00000000]                  call    [exit]       ; call exit to terminate the program
