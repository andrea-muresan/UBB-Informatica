     1                                  bits 32 ; assembling for the 32 bits architecture
     2                                  
     3                                  
     4                                  global start        
     5                                  
     6                                  
     7                                  extern exit, fopen, fclose, printf, fprintf, scanf, gets, getchar
     8                                  import exit msvcrt.dll
     9                                  import fopen msvcrt.dll
    10                                  import fclose msvcrt.dll
    11                                  import fprintf msvcrt.dll
    12                                  import printf msvcrt.dll
    13                                  import scanf msvcrt.dll
    14                                  import gets msvcrt.dll
    15                                  import getchar msvcrt.dll
    16                                  
    17                                  segment data use32 class=data
    18 00000000 00<rept>                    nume_fisier times 30 db 0
    19 0000001E 7700                        mod_acces db "w", 0
    20 00000020 FFFFFFFF                    descriptor dd -1
    21                                      
    22 00000024 00<rept>                    text times 130 db 0
    23                                      
    24 000000A6 496E74726F64756365-         mesaj_nume_fis db "Introduceti numele fisierului: ", 0
    24 000000AF 7469206E756D656C65-
    24 000000B8 20666973696572756C-
    24 000000C1 75693A2000         
    25 000000C6 496E74726F64756365-         mesaj_text db "Introduceti textul: ", 0
    25 000000CF 74692074657874756C-
    25 000000D8 3A2000             
    26                                      
    27 000000DB 257300                      format_cit db "%s", 0
    28 000000DE 257300                      format_afis db "%s", 0
    29                                      
    30 000000E1 437265617265612066-         eroare db "Crearea fisierului a esuat", 0
    30 000000EA 6973696572756C7569-
    30 000000F3 206120657375617400 
    31                                  
    32                                  ; 10. Sa se citeasca de la tastatura un nume de fisier si un text. Sa se creeze un fisier cu numele dat in directorul curent si sa se scrie textul in acel fisier. Observatii: Numele de fisier este de maxim 30 de car
    33                                  segment code use32 class=code
    34                                      start:
    35                                          ;mesaj nume fisier
    36 00000000 68[A6000000]                    push dword mesaj_nume_fis
    37 00000005 FF15[00000000]                  call [printf]
    38 0000000B 83C404                          add esp, 4
    39                                          
    40                                          ; scanf(format_cit, nume_fisier)
    41 0000000E 68[00000000]                    push dword nume_fisier
    42 00000013 68[DB000000]                    push dword format_cit
    43 00000018 FF15[00000000]                  call [scanf]
    44 0000001E 83C408                          add esp, 4*2
    45                                          
    46 00000021 FF15[00000000]                  call [getchar]
    47                                          
    48                                          ; mesaj text
    49 00000027 68[C6000000]                    push dword mesaj_text
    50 0000002C FF15[00000000]                  call [printf]
    51 00000032 83C404                          add esp, 4
    52                                          
    53                                          ; gets(text)
    54 00000035 68[24000000]                    push dword text
    55 0000003A FF15[00000000]                  call [gets]
    56 00000040 83C404                          add esp, 4
    57                                          
    58                                          ; creare fisier - se realizeaza automat la deschidere (mod de acces - write)
    59                                          ; fopen(nume_fisier, mod_acces)
    60 00000043 68[1E000000]                    push dword mod_acces
    61 00000048 68[00000000]                    push dword nume_fisier
    62 0000004D FF15[00000000]                  call [fopen]
    63 00000053 83C408                          add esp, 4*2
    64                                          
    65 00000056 83F800                          cmp eax, 0
    66 00000059 742F                            je eroare_deschidere
    67                                          
    68 0000005B A3[20000000]                    mov [descriptor], eax
    69                                          
    70                                          ; fprintf(descriptor, format_afis, text)
    71 00000060 68[24000000]                    push dword text
    72 00000065 68[DE000000]                    push dword format_afis
    73 0000006A FF35[20000000]                  push dword [descriptor]
    74 00000070 FF15[00000000]                  call [fprintf]
    75 00000076 83C40C                          add esp, 4*3
    76                                          
    77                                          
    78                                          ; fclose(descriptor)
    79 00000079 FF35[20000000]                  push dword [descriptor]
    80 0000007F FF15[00000000]                  call [fclose]
    81 00000085 83C404                          add esp, 4
    82                                          
    83 00000088 EB0E                            jmp final
    84                                          eroare_deschidere:
    85 0000008A 68[E1000000]                        push dword eroare
    86 0000008F FF15[00000000]                      call [printf]
    87 00000095 83C404                              add esp, 4
    88                                          final:
    89                                          ; exit(0)
    90 00000098 6A00                            push    dword 0      ; push the parameter for exit onto the stack
    91 0000009A FF15[00000000]                  call    [exit]       ; call exit to terminate the program
