     1                                  ; oprim executia la intalnirea caracterului '$', chiar daca se afla in interiorul unui cuvant (ex, '$Ana', 'me$re', 'pere$') - cuvantul nu este luat deloc in considerare
     2                                  
     3                                  bits 32 
     4                                  
     5                                  global start        
     6                                  
     7                                  extern exit, fopen, fclose, scanf, fprintf, printf
     8                                  import exit msvcrt.dll
     9                                  import fopen msvcrt.dll
    10                                  import fclose msvcrt.dll
    11                                  import scanf msvcrt.dll
    12                                  import fprintf msvcrt.dll
    13                                  import printf msvcrt.dll
    14                                  
    15                                  segment data use32 class=data
    16 00000000 6669736965722E7478-         nume_fisier db "fisier.txt", 0
    16 00000009 7400               
    17 0000000B 7700                        mod_acces db "w", 0
    18 0000000D FFFFFFFF                    descriptor dd -1
    19                                      
    20 00000011 2400                        dolar db '$', 0
    21 00000013 00<rept>                    n times 50 db 0
    22                                      
    23 00000045 257300                      format_cit db "%s", 0
    24 00000048 25732000                    format_afis db "%s ", 0
    25                                      
    26 0000004C 444573636869646572-         eroare db "DEschiderea fisierului a esuat", 0
    26 00000055 656120666973696572-
    26 0000005E 756C75692061206573-
    26 00000067 75617400           
    27                                      
    28                                  
    29                                  ; Se da un nume de fisier (definit in segmentul de date). Sa se creeze un fisier cu numele dat, apoi sa se citeasca de la tastatura cuvinte pana cand se citeste de la tastatura caracterul '$'. Sa se scrie in fisier 
    30                                  segment code use32 class=code
    31                                      start:
    32 00000000 B024                            mov al, '$'
    33 00000002 A2[11000000]                    mov [dolar], al
    34                                          
    35                                          ; fopen(nume_fisier, mod_acces)
    36 00000007 68[0B000000]                    push dword mod_acces
    37 0000000C 68[00000000]                    push dword nume_fisier
    38 00000011 FF15[00000000]                  call [fopen]
    39 00000017 83C408                          add esp, 4*2
    40                                          
    41 0000001A 83F800                          cmp eax, 0
    42 0000001D 0F8486000000                    je eroare_deschidere
    43                                          
    44 00000023 A3[0D000000]                    mov [descriptor], eax
    45                                          
    46                                          repeta:
    47                                              ; scanf(format_cit, n)
    48 00000028 68[13000000]                        push dword n
    49 0000002D 68[45000000]                        push dword format_cit
    50 00000032 FF15[00000000]                      call [scanf]
    51 00000038 83C408                              add esp, 4*2
    52                                              
    53                                              ; verificam daca exista caracterul '$' in cuvant
    54 0000003B FC                                  cld
    55 0000003C BE[13000000]                        mov esi, n
    56 00000041 B932000000                          mov ecx, 50
    57                                              repeta2:
    58 00000046 AC                                      lodsb
    59 00000047 3A05[11000000]                          cmp al, [dolar]
    60 0000004D 7449                                    je afara
    61 0000004F E2F5                                loop repeta2
    62                                          
    63                                              ; verificare litera mare
    64 00000051 BE[13000000]                        mov esi, n
    65 00000056 B932000000                          mov ecx , 50
    66                                              bucla:
    67 0000005B AC                                      lodsb
    68 0000005C 3C41                                    cmp al, 'A'
    69 0000005E 7C1F                                    jl not_uppercase
    70                                                  
    71 00000060 3C5A                                    cmp al, 'Z'
    72 00000062 7F1B                                    jg not_uppercase
    73                                                  
    74                                                  ; fprintf(descriptor, format_afis, n)
    75 00000064 68[13000000]                            push dword n
    76 00000069 68[48000000]                            push dword format_afis
    77 0000006E FF35[0D000000]                          push dword [descriptor]
    78 00000074 FF15[00000000]                          call [fprintf]
    79 0000007A 83C40C                                  add esp, 4*3
    80 0000007D EB02                                    jmp next
    81                                                  
    82                                                  not_uppercase:
    83                                                  
    84 0000007F E2DA                                    loop bucla
    85                                                  
    86                                              next:
    87                                                  
    88                                              ; clear n
    89 00000081 BE[13000000]                        mov esi, n
    90 00000086 BF[13000000]                        mov edi, n
    91 0000008B B932000000                          mov ecx, 50
    92                                              ciclu:
    93 00000090 AC                                      lodsb
    94 00000091 30C0                                    xor al, al
    95 00000093 AA                                      stosb
    96 00000094 E2FA                                loop ciclu    
    97                                              
    98 00000096 EB90                                jmp repeta
    99                                              
   100                                          afara:
   101                                          
   102                                          ; fclose(descriptor)
   103 00000098 FF35[0D000000]                  push dword [descriptor]
   104 0000009E FF15[00000000]                  call [fclose]
   105 000000A4 83C404                          add esp, 4
   106                                          
   107 000000A7 EB0E                            jmp final
   108                                          eroare_deschidere:
   109 000000A9 68[4C000000]                        push dword eroare
   110 000000AE FF15[00000000]                      call [printf]
   111 000000B4 83C404                              add esp, 4
   112                                              
   113                                          final:
   114                                          ; exit(0)
   115 000000B7 6A00                            push    dword 0      ; push the parameter for exit onto the stack
   116 000000B9 FF15[00000000]                  call    [exit]       ; call exit to terminate the program
