     1                                  bits 32 
     2                                  
     3                                  global start        
     4                                  
     5                                  extern exit, fopen, fclose, printf, fprintf
     6                                  import exit msvcrt.dll    
     7                                  import fopen msvcrt.dll    
     8                                  import fclose msvcrt.dll    
     9                                  import printf msvcrt.dll    
    10                                  import fprintf msvcrt.dll    
    11                                  
    12                                  segment data use32 class=data
    13 00000000 6669736965722E7478-         nume_fisier db "fisier.txt", 0
    13 00000009 7400               
    14 0000000B 7700                        mod_acces db "w", 0
    15 0000000D FFFFFFFF                    descriptor dd -1
    16                                      
    17 00000011 416E61206172652031-         text db "Ana are 12 mere. Maria are 3 pere. 12 + 3 = 15 fructe", 0
    17 0000001A 32206D6572652E204D-
    17 00000023 617269612061726520-
    17 0000002C 3320706572652E2031-
    17 00000035 32202B2033203D2031-
    17 0000003E 352066727563746500 
    18                                      len equ $ - text - 1
    19 00000047 4300                        c db 'C', 0
    20                                      
    21 00000049 257300                      format_afisare db "%s", 0
    22                                      
    23 0000004C 446573636869646572-         eroare db "Deschiderea fisierului a esuat", 0
    23 00000055 656120666973696572-
    23 0000005E 756C75692061206573-
    23 00000067 75617400           
    24                                  
    25                                  ; 24. Se dau un nume de fisier si un text (definite in segmentul de date). Textul contine litere mici, litere mari, cifre si caractere speciale. Sa se inlocuiasca toate CIFRELE din textul dat cu caracterul 'C'. Sa s
    26                                  segment code use32 class=code
    27                                      start:
    28                                          ; fopen(nume_fisier, mod_acces)
    29 00000000 68[0B000000]                    push dword mod_acces
    30 00000005 68[00000000]                    push dword nume_fisier
    31 0000000A FF15[00000000]                  call [fopen]
    32 00000010 83C408                          add esp, 4*2
    33                                          
    34 00000013 83F800                          cmp eax, 0
    35 00000016 7454                            je eroare_deschidere
    36                                          
    37 00000018 A3[0D000000]                    mov [descriptor], eax
    38                                          
    39 0000001D B935000000                      mov ecx, len
    40                                          repeta:
    41 00000022 80B9[11000000]30                    cmp [text + ecx], byte '0'
    42 00000029 7C15                                jl next
    43                                              
    44 0000002B 80B9[11000000]39                    cmp [text + ecx], byte '9'
    45 00000032 7F0C                                jg next
    46                                              
    47 00000034 8A1D[47000000]                      mov bl, [c]
    48 0000003A 8899[11000000]                      mov [text + ecx], bl
    49                                              
    50                                              next:
    51 00000040 E2E0                            loop repeta
    52                                          
    53                                          ; fprintf(descriptor, format_afisare, val)
    54 00000042 68[11000000]                    push dword text
    55 00000047 68[49000000]                    push dword format_afisare
    56 0000004C FF35[0D000000]                  push dword [descriptor]
    57 00000052 FF15[00000000]                  call [fprintf]
    58 00000058 83C40C                          add esp, 4*3
    59                                          
    60                                          
    61                                          ; fclose(descriptor)
    62 0000005B FF35[0D000000]                  push dword [descriptor]
    63 00000061 FF15[00000000]                  call [fclose]
    64 00000067 83C404                          add esp, 4
    65                                          
    66 0000006A EB0E                            jmp final
    67                                          eroare_deschidere:
    68 0000006C 68[4C000000]                        push dword eroare
    69 00000071 FF15[00000000]                      call [printf]
    70 00000077 83C404                              add esp, 4
    71                                          
    72                                          final:
    73                                          ; exit(0)
    74 0000007A 6A00                            push    dword 0      ; push the parameter for exit onto the stack
    75 0000007C FF15[00000000]                  call    [exit]       ; call exit to terminate the program
