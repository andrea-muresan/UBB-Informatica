     1                                  bits 32 
     2                                  
     3                                  global start        
     4                                  
     5                                  extern exit, fopen, fclose, fprintf, printf, scanf
     6                                  import exit msvcrt.dll
     7                                  import fopen msvcrt.dll
     8                                  import fclose msvcrt.dll
     9                                  import scanf msvcrt.dll
    10                                  import fprintf msvcrt.dll
    11                                  import printf msvcrt.dll
    12                                  
    13                                  segment data use32 class=data
    14 00000000 6669736965722E7478-         nume_fisier db "fisier.txt", 0
    14 00000009 7400               
    15 0000000B 7700                        mod_acces db "w", 0
    16 0000000D FFFFFFFF                    descriptor dd -1
    17                                      
    18 00000011 00<rept>                    dolar times 50 db 0
    19 00000043 00<rept>                    n times 50 db 0
    20                                      
    21                                      
    22 00000075 257300                      format_cit db "%s", 0
    23 00000078 25732000                    format_afis db "%s ", 0
    24                                      
    25                                      
    26 0000007C 446573636869646572-         eroare db "Deschiderea fisierului a esuat", 0
    26 00000085 656120666973696572-
    26 0000008E 756C75692061206573-
    26 00000097 75617400           
    27                                  
    28                                  ; 11. Se da un nume de fisier (definit in segmentul de date). Sa se creeze un fisier cu numele dat, apoi sa se citeasca de la tastatura cuvinte si sa se scrie in fisier cuvintele citite pana cand se citeste de la ta
    29                                  segment code use32 class=code
    30                                      start:
    31 00000000 B024                            mov al, '$'
    32 00000002 A2[11000000]                    mov [dolar], al
    33                                          
    34                                          ; fopen
    35 00000007 68[0B000000]                    push dword mod_acces
    36 0000000C 68[00000000]                    push dword nume_fisier
    37 00000011 FF15[00000000]                  call [fopen]
    38 00000017 83C408                          add esp, 4*2
    39                                          
    40                                          
    41 0000001A 83F800                          cmp eax, 0
    42 0000001D 7458                            je eroare_deschidere
    43                                          
    44 0000001F A3[0D000000]                    mov [descriptor], eax
    45                                          
    46                                          repeta:
    47                                              ; scanf
    48 00000024 68[43000000]                        push dword n
    49 00000029 68[75000000]                        push dword format_cit
    50 0000002E FF15[00000000]                      call [scanf]
    51 00000034 83C408                              add esp, 4*2
    52                                              
    53 00000037 FC                                  cld
    54 00000038 BE[43000000]                        mov esi, n 
    55 0000003D BF[11000000]                        mov edi, dolar
    56 00000042 B932000000                          mov ecx, 50
    57 00000047 F3A6                                repe cmpsb
    58 00000049 E31B                                jecxz afara
    59                                              
    60                                              ; fprintf
    61 0000004B 68[43000000]                        push dword n
    62 00000050 68[78000000]                        push dword format_afis
    63 00000055 FF35[0D000000]                      push dword [descriptor]
    64 0000005B FF15[00000000]                      call [fprintf]
    65 00000061 83C40C                              add esp, 4*3
    66                                              
    67                                              ; clear
    68                                              ; mov ecx, 50
    69                                              ; mov esi, n
    70                                              ; mov edi, n
    71                                              ; bucla:
    72                                                  ; lodsb
    73                                                  ; xor al, al
    74                                                  ; stosb
    75                                              ; loop bucla
    76                                              
    77 00000064 EBBE                                jmp repeta
    78                                          
    79                                          afara:
    80                                          
    81                                          ; fclose
    82 00000066 FF35[0D000000]                  push dword [descriptor]
    83 0000006C FF15[00000000]                  call [fclose]
    84 00000072 83C404                          add esp, 4
    85                                          
    86 00000075 EB0E                            jmp final
    87                                          eroare_deschidere:
    88 00000077 68[7C000000]                        push dword eroare
    89 0000007C FF15[00000000]                      call [printf]
    90 00000082 83C404                              add esp, 4
    91                                          final:
    92                                          ; exit(0)
    93 00000085 6A00                            push    dword 0      ; push the parameter for exit onto the stack
    94 00000087 FF15[00000000]                  call    [exit]       ; call exit to terminate the program
